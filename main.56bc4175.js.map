{"version":3,"sources":["scripts/main.js"],"names":["countOfNewCellsWhenStart","start","document","querySelector","startMessage","loseMessage","winMessage","gameFieldCells","querySelectorAll","score","fieldArray","startGame","classList","remove","add","textContent","addEventListener","contains","restart","i","addNewCell","updateCells","scoreValue","gameOver","moveLeft","row","nonZeroCells","filterRow","length","cell","updateScore","moveCell","moveRight","canMoveHorizontally","move","arr","copyFieldArray","flatArray","areArraysEqual","checkIfLose","canMoveVertically","arrayRotated","rotateArray","arrayRotatedFlat","arrayBack","rotateArrayBack","j","reverse","emptyIndxs","map","rowIndex","col","colIndex","flat","filter","index","randIndex","Math","floor","random","gameCells","setValueToCell","canMergeCell","hasEmptyCell","includes","item","arr1","arr2","every","value","cells","newRows","push","e","key"],"mappings":";AAAA,aAmSC,SAAA,EAAA,EAAA,GAAA,OAAA,EAAA,IAAA,EAAA,EAAA,IAAA,EAAA,EAAA,IAAA,IAAA,SAAA,IAAA,MAAA,IAAA,UAAA,6IAAA,SAAA,EAAA,EAAA,GAAA,GAAA,oBAAA,QAAA,OAAA,YAAA,OAAA,GAAA,CAAA,IAAA,EAAA,GAAA,GAAA,EAAA,GAAA,EAAA,OAAA,EAAA,IAAA,IAAA,IAAA,EAAA,EAAA,EAAA,OAAA,cAAA,GAAA,EAAA,EAAA,QAAA,QAAA,EAAA,KAAA,EAAA,QAAA,GAAA,EAAA,SAAA,GAAA,GAAA,IAAA,MAAA,GAAA,GAAA,EAAA,EAAA,EAAA,QAAA,IAAA,GAAA,MAAA,EAAA,QAAA,EAAA,SAAA,QAAA,GAAA,EAAA,MAAA,GAAA,OAAA,GAAA,SAAA,EAAA,GAAA,GAAA,MAAA,QAAA,GAAA,OAAA,EAAA,SAAA,EAAA,GAAA,GAAA,oBAAA,QAAA,MAAA,EAAA,OAAA,UAAA,CAAA,GAAA,MAAA,QAAA,KAAA,EAAA,EAAA,IAAA,CAAA,IAAA,EAAA,EAAA,EAAA,aAAA,MAAA,CAAA,EAAA,EAAA,EAAA,WAAA,OAAA,GAAA,EAAA,OAAA,CAAA,MAAA,GAAA,CAAA,MAAA,EAAA,MAAA,EAAA,OAAA,EAAA,SAAA,GAAA,MAAA,GAAA,EAAA,GAAA,MAAA,IAAA,UAAA,yIAAA,IAAA,EAAA,EAAA,GAAA,EAAA,GAAA,EAAA,MAAA,CAAA,EAAA,WAAA,EAAA,EAAA,OAAA,aAAA,EAAA,WAAA,IAAA,EAAA,EAAA,OAAA,OAAA,EAAA,EAAA,KAAA,GAAA,EAAA,SAAA,GAAA,GAAA,EAAA,EAAA,GAAA,EAAA,WAAA,IAAA,GAAA,MAAA,EAAA,QAAA,EAAA,SAAA,QAAA,GAAA,EAAA,MAAA,KAAA,SAAA,EAAA,EAAA,GAAA,GAAA,EAAA,CAAA,GAAA,iBAAA,EAAA,OAAA,EAAA,EAAA,GAAA,IAAA,EAAA,OAAA,UAAA,SAAA,KAAA,GAAA,MAAA,GAAA,GAAA,MAAA,WAAA,GAAA,EAAA,cAAA,EAAA,EAAA,YAAA,MAAA,QAAA,GAAA,QAAA,EAAA,MAAA,KAAA,GAAA,cAAA,GAAA,2CAAA,KAAA,GAAA,EAAA,EAAA,QAAA,GAAA,SAAA,EAAA,EAAA,IAAA,MAAA,GAAA,EAAA,EAAA,UAAA,EAAA,EAAA,QAAA,IAAA,IAAA,EAAA,EAAA,EAAA,IAAA,MAAA,GAAA,EAAA,EAAA,IAAA,EAAA,GAAA,EAAA,GAAA,OAAA,EAjSD,IAAMA,EAA2B,EAE3BC,EAAQC,SAASC,cAAc,UAE/BC,EAAeF,SAASC,cAAc,kBACtCE,EAAcH,SAASC,cAAc,iBACrCG,EAAaJ,SAASC,cAAc,gBAEpCI,EAAiBL,SAASM,iBAAiB,eAC3CC,EAAQP,SAASC,cAAc,eAE/BO,EAAa,CACjB,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,IAeZ,SAASC,IACPV,EAAMW,UAAUC,OAAO,SACvBZ,EAAMW,UAAUE,IAAI,WACpBb,EAAMc,YAAc,UACpBX,EAAaQ,UAAUE,IAAI,UAC3BR,EAAWM,UAAUE,IAAI,UAjB3Bb,EAAMe,iBAAiB,QAAS,WAC1Bf,EAAMW,UAAUK,SAAS,UAC3BN,IAEFO,IAEK,IAAA,IAAIC,EAAI,EAAGA,EAAInB,EAA0BmB,IAC5CC,EAAWV,GACXW,EAAYd,EAAgBG,KAYhC,IAAIY,EAAa,EACbC,GAAW,EA+Bf,SAASC,EAASC,GAGX,IAFDC,IAAAA,EAAeC,EAAUF,GAEpBN,EAAI,EAAGA,EAAIO,EAAaE,OAAQT,IAAK,CACtCU,IAAAA,EAAOH,EAAaP,GAGtBU,IAFaH,EAAaP,EAAI,KAGhCO,EAAaP,GAAY,EAAPU,EAClBP,GAAcI,EAAaP,GAC3BO,EAAaP,EAAI,GAAK,EACtBW,KAIJJ,EAAeC,EAAUD,GAEpB,IAAA,IAAIP,EAAI,EAAGA,EAAIM,EAAIG,OAAQT,IAC9BM,EAAIN,GAAKO,EAAaP,IAAM,EAIhC,SAASY,EAASN,GAChBD,EAASC,GACTO,EAAUP,GAGZ,SAASQ,EAAoBC,EAAMC,GACjCJ,EAASI,GAEHC,IAHgC,EAGhCA,EAAiBC,EAAUF,GAEfA,EAAAA,EAAAA,GALoB,IAKf,IAAA,EAAA,MAAA,EAAA,EAAA,KAAA,MAAA,CACrBD,EADqB,EAAA,QALe,MAAA,GAAA,EAAA,EAAA,GAAA,QAAA,EAAA,IASjCI,EAAeF,EAAgBC,EAAUF,MAC5Cf,EAAWe,GACXI,EAAYJ,GACZd,EAAYd,EAAgB4B,IAIhC,SAASK,EAAkBN,EAAMC,GAC/BJ,EAASI,GAKJ,IAHCM,IAAAA,EAAeC,EAAYP,GAC3BQ,EAAmBN,EAAUI,GAE1BtB,EAAI,EAAGA,EAAIsB,EAAab,OAAQT,IACvCe,EAAKO,EAAatB,IAGhB,IAACmB,EACHK,EAAkBN,EAAUI,IAAgB,CAC5CrB,EAAWqB,GACXF,EAAYJ,GAIP,IAFCS,IAAAA,EAAYC,EAAgBJ,GAEzBtB,EAAI,EAAGA,EAAIyB,EAAUhB,OAAQT,IAC/B,IAAA,IAAI2B,EAAI,EAAGA,EAAIF,EAAUzB,GAAGS,OAAQkB,IACvCX,EAAIhB,GAAG2B,GAAKF,EAAUzB,GAAG2B,GAI7BzB,EAAYd,EAAgBqC,IAIhC,SAASZ,EAAUP,GACjBD,EAASC,EAAIsB,WACbtB,EAAIsB,UAGN,SAAS3B,EAAWe,GACZa,IAAAA,EAAab,EAChBc,IAAI,SAACxB,EAAKyB,GAAazB,OAAAA,EAAIwB,IAC1B,SAACE,EAAKC,GAAaD,OAAQ,IAARA,EAAY,CAACD,EAAUE,GAAY,SACvDC,OACAC,OAAO,SAAAC,GAASA,OAAU,OAAVA,IAEfP,GAAAA,EAAWpB,OAAS,EAAG,CACnB4B,IACuBA,EAAAA,EADXR,EAAWS,KAAKC,MAAMD,KAAKE,SAAWX,EAAWpB,SAD1C,GAElBsB,EAFkB,EAAA,GAERE,EAFQ,EAAA,GAIzBjB,EAAIe,GAAUE,GAAYK,KAAKE,UAAY,GAAM,EAAI,EACrDpB,EAAYJ,GACZL,KAIJ,SAAST,EAAYuC,EAAWzB,GAG9B0B,EAAeD,EAFQvB,EAAUF,IAKnC,SAASL,IACPrB,EAAMM,YAAcO,EAEFZ,IAHG,EAGHA,EAAAA,EAAAA,GAHG,IAGS,IAAA,EAAA,MAAA,EAAA,EAAA,KAAA,MAAA,CAAnBe,IAAmB,EACTA,EAAAA,EADS,EAAA,OAAA,IACJ,IAAA,EAAA,MAAA,EAAA,EAAA,KAAA,MAAA,CAClBI,GAAS,OADS,EAAA,MAKpB,OAHAvB,EAAWM,UAAUC,OAAO,eAC5BU,GAAW,IAJa,MAAA,GAAA,EAAA,EAAA,GAAA,QAAA,EAAA,MAHT,MAAA,GAAA,EAAA,EAAA,GAAA,QAAA,EAAA,KAevB,SAASgB,EAAYJ,GACd2B,KAAmBC,EAAa5B,KACnC9B,EAAYO,UAAUC,OAAO,UAC7BU,GAAW,GAIf,SAASwC,EAAa5B,GACFA,IADO,EACPA,EAAAA,EAAAA,GADO,IACF,IAAA,EAAA,MAAA,EAAA,EAAA,KAAA,MAAA,CACjBV,GADiB,EAAA,MACbuC,SAAS,GACR,OAAA,GAHc,MAAA,GAAA,EAAA,EAAA,GAAA,QAAA,EAAA,IAOlB,OAAA,EAGT,SAASF,IACF,IAAA,IAAI3C,EAAI,EAAGA,EAAIT,EAAWkB,OAAQT,IAGhC,IAFCM,IAAAA,EAAMf,EAAWS,GAEd2B,EAAI,EAAGA,EAAIrB,EAAIG,OAAS,EAAGkB,IAC9BrB,GAAAA,EAAIqB,KAAOrB,EAAIqB,EAAI,GACd,OAAA,EAKR,IAAA,IAAI3B,EAAI,EAAGA,EAAIT,EAAWkB,OAAS,EAAGT,IACpC,IAAA,IAAI2B,EAAI,EAAGA,EAAIpC,EAAWS,GAAGS,OAAQkB,IACpCpC,GAAAA,EAAWS,GAAG2B,KAAOpC,EAAWS,EAAI,GAAG2B,GAClC,OAAA,EAKN,OAAA,EAGT,SAASnB,EAAUF,GACVA,OAAAA,EAAI6B,OAAO,SAAAW,GAAQA,OAAS,IAATA,IAG5B,SAAS5B,EAAUF,GACVA,OAAAA,EAAIkB,OAGb,SAASf,EAAe4B,EAAMC,GACrBD,OAAAA,EAAKtC,SAAWuC,EAAKvC,QAAUsC,EAAKE,MACzC,SAACC,EAAOd,GAAUc,OAAAA,IAAUF,EAAKZ,KAGrC,SAASrC,IACF,IAAA,IAAIC,EAAI,EAAGA,EAAIT,EAAWkB,OAAQT,IACrCT,EAAWS,GAAK,CAAC,EAAG,EAAG,EAAG,GAG5BI,GAAW,EAEXlB,EAAYO,UAAUE,IAAI,UAC1BR,EAAWM,UAAUE,IAAI,UAEzBQ,EAAa,EACbQ,IAGF,SAAS+B,EAAeS,EAAOnC,GACxB,IAAA,IAAIhB,EAAI,EAAGA,EAAImD,EAAM1C,OAAQT,IACjB,IAAXgB,EAAIhB,IACNmD,EAAMnD,GAAGJ,YAAc,GACvBuD,EAAMnD,GAAGP,UAAY,eAErB0D,EAAMnD,GAAGJ,YAAcoB,EAAIhB,GAC3BmD,EAAMnD,GAAGP,UAAsCuB,0BAAAA,OAAAA,EAAIhB,KAKzD,SAASuB,EAAYP,GAGd,IAFCoC,IAAAA,EAAU,GAEPpD,EAAI,EAAGA,EAAIgB,EAAIP,OAAQT,IAAK,CAG9B,IAFCM,IAAAA,EAAM,GAEHqB,EAAIX,EAAIP,OAAS,EAAGkB,GAAK,EAAGA,IACnCrB,EAAI+C,KAAKrC,EAAIW,GAAG3B,IAElBoD,EAAQC,KAAK/C,GAGR8C,OAAAA,EAGT,SAAS1B,EAAgBV,GAGlB,IAFCoC,IAAAA,EAAU,GAEPpD,EAAIgB,EAAIP,OAAS,EAAGT,GAAK,EAAGA,IAAK,CAGnC,IAFCM,IAAAA,EAAM,GAEHqB,EAAI,EAAGA,EAAIX,EAAIhB,GAAGS,OAAQkB,IACjCrB,EAAI+C,KAAKrC,EAAIW,GAAG3B,IAElBoD,EAAQC,KAAK/C,GAGR8C,OAAAA,EAvPTrE,SAASc,iBAAiB,QAAS,SAACyD,GAC9BlD,IAAAA,EAAAA,CAIIkD,OAAAA,EAAEC,KACH,IAAA,YACHzC,EAAoBT,EAAUd,GAC9BoB,IACA,MAEG,IAAA,aACHG,EAAoBD,EAAWtB,GAC/BoB,IACA,MAEG,IAAA,UACHU,EAAkBR,EAAWtB,GAC7BoB,IACA,MAEG,IAAA,YACHU,EAAkBhB,EAAUd,GAC5BoB,IAGJS,EAAY7B","file":"main.56bc4175.js","sourceRoot":"..\\src","sourcesContent":["'use strict';\n\nconst countOfNewCellsWhenStart = 2;\n\nconst start = document.querySelector('.start');\n\nconst startMessage = document.querySelector('.message-start');\nconst loseMessage = document.querySelector('.message-lose');\nconst winMessage = document.querySelector('.message-win');\n\nconst gameFieldCells = document.querySelectorAll('.field-cell');\nconst score = document.querySelector('.game-score');\n\nconst fieldArray = [\n  [0, 0, 0, 0],\n  [0, 0, 0, 0],\n  [0, 0, 0, 0],\n  [0, 0, 0, 0],\n];\n\nstart.addEventListener('click', () => {\n  if (start.classList.contains('start')) {\n    startGame();\n  }\n  restart();\n\n  for (let i = 0; i < countOfNewCellsWhenStart; i++) {\n    addNewCell(fieldArray);\n    updateCells(gameFieldCells, fieldArray);\n  }\n});\n\nfunction startGame() {\n  start.classList.remove('start');\n  start.classList.add('restart');\n  start.textContent = 'Restart';\n  startMessage.classList.add('hidden');\n  winMessage.classList.add('hidden');\n}\n\nlet scoreValue = 0;\nlet gameOver = false;\n\ndocument.addEventListener('keyup', (e) => {\n  if (gameOver) {\n    return;\n  }\n\n  switch (e.key) {\n    case 'ArrowLeft':\n      canMoveHorizontally(moveLeft, fieldArray);\n      updateScore();\n      break;\n\n    case 'ArrowRight':\n      canMoveHorizontally(moveRight, fieldArray);\n      updateScore();\n      break;\n\n    case 'ArrowUp':\n      canMoveVertically(moveRight, fieldArray);\n      updateScore();\n      break;\n\n    case 'ArrowDown':\n      canMoveVertically(moveLeft, fieldArray);\n      updateScore();\n  }\n\n  checkIfLose(fieldArray);\n});\n\nfunction moveLeft(row) {\n  let nonZeroCells = filterRow(row);\n\n  for (let i = 0; i < nonZeroCells.length; i++) {\n    const cell = nonZeroCells[i];\n    const nextCell = nonZeroCells[i + 1];\n\n    if (cell === nextCell) {\n      nonZeroCells[i] = cell * 2;\n      scoreValue += nonZeroCells[i];\n      nonZeroCells[i + 1] = 0;\n      updateScore();\n    }\n  }\n\n  nonZeroCells = filterRow(nonZeroCells);\n\n  for (let i = 0; i < row.length; i++) {\n    row[i] = nonZeroCells[i] || 0;\n  }\n}\n\nfunction moveCell(row) {\n  moveLeft(row);\n  moveRight(row);\n}\n\nfunction canMoveHorizontally(move, arr) {\n  moveCell(arr);\n\n  const copyFieldArray = flatArray(arr);\n\n  for (const row of arr) {\n    move(row);\n  }\n\n  if (!areArraysEqual(copyFieldArray, flatArray(arr))) {\n    addNewCell(arr);\n    checkIfLose(arr);\n    updateCells(gameFieldCells, arr);\n  }\n}\n\nfunction canMoveVertically(move, arr) {\n  moveCell(arr);\n\n  const arrayRotated = rotateArray(arr);\n  const arrayRotatedFlat = flatArray(arrayRotated);\n\n  for (let i = 0; i < arrayRotated.length; i++) {\n    move(arrayRotated[i]);\n  }\n\n  if (!areArraysEqual(\n    arrayRotatedFlat, flatArray(arrayRotated))) {\n    addNewCell(arrayRotated);\n    checkIfLose(arr);\n\n    const arrayBack = rotateArrayBack(arrayRotated);\n\n    for (let i = 0; i < arrayBack.length; i++) {\n      for (let j = 0; j < arrayBack[i].length; j++) {\n        arr[i][j] = arrayBack[i][j];\n      }\n    }\n\n    updateCells(gameFieldCells, arrayBack);\n  }\n}\n\nfunction moveRight(row) {\n  moveLeft(row.reverse());\n  row.reverse();\n}\n\nfunction addNewCell(arr) {\n  const emptyIndxs = arr\n    .map((row, rowIndex) => row.map(\n      (col, colIndex) => col === 0 ? [rowIndex, colIndex] : null))\n    .flat()\n    .filter(index => index !== null);\n\n  if (emptyIndxs.length > 0) {\n    const randIndex = emptyIndxs[Math.floor(Math.random() * emptyIndxs.length)];\n    const [rowIndex, colIndex] = randIndex;\n\n    arr[rowIndex][colIndex] = Math.random() <= 0.9 ? 2 : 4;\n    checkIfLose(arr);\n    updateScore();\n  }\n}\n\nfunction updateCells(gameCells, arr) {\n  const flatFieldArray = flatArray(arr);\n\n  setValueToCell(gameCells, flatFieldArray);\n}\n\nfunction updateScore() {\n  score.textContent = scoreValue;\n\n  for (const row of fieldArray) {\n    for (const cell of row) {\n      if (cell === 2048) {\n        winMessage.classList.remove('hidden');\n        gameOver = true;\n\n        return;\n      }\n    }\n  }\n}\n\nfunction checkIfLose(arr) {\n  if (!canMergeCell() && !hasEmptyCell(arr)) {\n    loseMessage.classList.remove('hidden');\n    gameOver = true;\n  }\n}\n\nfunction hasEmptyCell(arr) {\n  for (const row of arr) {\n    if (row.includes(0)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction canMergeCell() {\n  for (let i = 0; i < fieldArray.length; i++) {\n    const row = fieldArray[i];\n\n    for (let j = 0; j < row.length - 1; j++) {\n      if (row[j] === row[j + 1]) {\n        return true;\n      }\n    }\n  }\n\n  for (let i = 0; i < fieldArray.length - 1; i++) {\n    for (let j = 0; j < fieldArray[i].length; j++) {\n      if (fieldArray[i][j] === fieldArray[i + 1][j]) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nfunction filterRow(row) {\n  return row.filter(item => item !== 0);\n}\n\nfunction flatArray(arr) {\n  return arr.flat();\n}\n\nfunction areArraysEqual(arr1, arr2) {\n  return arr1.length === arr2.length && arr1.every(\n    (value, index) => value === arr2[index]);\n}\n\nfunction restart() {\n  for (let i = 0; i < fieldArray.length; i++) {\n    fieldArray[i] = [0, 0, 0, 0];\n  }\n\n  gameOver = false;\n\n  loseMessage.classList.add('hidden');\n  winMessage.classList.add('hidden');\n\n  scoreValue = 0;\n  updateScore();\n}\n\nfunction setValueToCell(cells, arr) {\n  for (let i = 0; i < cells.length; i++) {\n    if (arr[i] === 0) {\n      cells[i].textContent = '';\n      cells[i].classList = 'field-cell';\n    } else {\n      cells[i].textContent = arr[i];\n      cells[i].classList = `field-cell field-cell--${arr[i]}`;\n    }\n  }\n}\n\nfunction rotateArray(arr) {\n  const newRows = [];\n\n  for (let i = 0; i < arr.length; i++) {\n    const row = [];\n\n    for (let j = arr.length - 1; j >= 0; j--) {\n      row.push(arr[j][i]);\n    }\n    newRows.push(row);\n  }\n\n  return newRows;\n}\n\nfunction rotateArrayBack(arr) {\n  const newRows = [];\n\n  for (let i = arr.length - 1; i >= 0; i--) {\n    const row = [];\n\n    for (let j = 0; j < arr[i].length; j++) {\n      row.push(arr[j][i]);\n    }\n    newRows.push(row);\n  }\n\n  return newRows;\n}\n"]}